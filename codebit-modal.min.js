function createCbModalSkeleton(){var e=document.createElement("div");e.className="cb-modal-backdrop";var t=document.createElement("div");e.appendChild(t);var a=document.createElement("div");t.appendChild(a);var d=document.createElement("div");d.className="cb-modal",a.appendChild(d);var o=document.createElement("div");o.className="cb-modal-head",d.appendChild(o);var i=document.createElement("div");i.className="cb-modal-body",d.appendChild(i);var n=document.createElement("div");return n.className="cb-modal-foot",d.appendChild(n),e}var showingCbModals=[];function CbModal(e){this.backdrop=e||createCbModalSkeleton(),this.animationTime=200,this.disattachWhenHidden=!0,this.onShown=null,this.onHidden=null;var d=this;(this.backdrop.modal=this).modal=this.backdrop.getElementsByClassName("cb-modal")[0],this.modalHead=this.backdrop.getElementsByClassName("cb-modal-head")[0],this.modalBody=this.backdrop.getElementsByClassName("cb-modal-body")[0],this.modalFoot=this.backdrop.getElementsByClassName("cb-modal-foot")[0],this.guid=function(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+"-"+e()+"-"+e()+"-"+e()+"-"+e()+e()+e()},this.modalHead.id=this.guid(),this.modalBody.id=this.guid(),this.modal.setAttribute("role","modal"),this.modal.setAttribute("aria-modal","true"),this.modal.setAttribute("aria-labelledby",this.modalHead.id),this.modal.setAttribute("aria-describedby",this.modalBody.id),this.modalBody.tabIndex=-1,this.blurBackdrop=function(e){for(var t=this.backdrop.parentElement.children,a=0;a<t.length;a++){var d=t[a];d===this.backdrop||0==d.offsetWidth&&0==d.offsetHeight||(e?d.classList.add("cb-modal-blur"):d.classList.remove("cb-modal-blur"))}},this.removeFromParent=function(){var e=this.backdrop.parentElement;null!=e&&e.removeChild(this.backdrop)},this.show=function(e){var t=this;this.backdrop.style.display="block";var a=5;null!=e&&(null==e.backdrop||null==e.backdrop.style||null==e.backdrop.style.zIndex?console.warn('The object passed as "childOf" is not a valid CbModal.'):(this.childOf=e,a=parseInt(e.backdrop.style.zIndex)+1)),this.backdrop.style.zIndex=a||"5",this.backdrop.parentElement!==document.body&&(this.removeFromParent(),document.body.appendChild(this.backdrop)),setTimeout(function(){t.backdrop.classList.add("show"),setTimeout(function(){null!=t.onShown&&t.onShown()},this.animationTime),showingCbModals.push(d)},50),t.blurBackdrop(!0),null!=document.activeElement&&document.activeElement.blur()},this.setZIndex=function(e){this.backdrop.style.zIndex=e},this.hide=function(){this.backdrop.classList.remove("show");var e=this;setTimeout(function(){e.backdrop.style.display="none",e.blurBackdrop(!1),e.disattachWhenHidden&&e.removeFromParent(),null!=e.onHidden&&e.onHidden(),showingCbModals.splice(showingCbModals.indexOf(d))},this.animationTime)}}document.addEventListener("keydown",function(e){"Escape"==e.key&&(0!=showingCbModals.length&&(showingCbModals[showingCbModals.length-1].hide(),e.stopPropagation()))});
